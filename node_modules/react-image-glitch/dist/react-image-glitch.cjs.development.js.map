{"version":3,"file":"react-image-glitch.cjs.development.js","sources":["../src/helpers.ts","../src/hooks.ts","../src/components/Slice.tsx","../src/components/GlitchedImage.tsx"],"sourcesContent":["import { DimensionsType, heightOffsetType } from \"./Typings\"\n\nexport const getRandomNumberBetween = (min: number, max: number) => {\n  return Math.floor(Math.random() * max) + min\n}\n\nexport const createSlices = (height: number) => {\n  let heightOffsets: heightOffsetType[] = []\n  for (let i = 0; i < height;) {\n    const randomHeight = getRandomNumberBetween(3, 20)\n    const newHeightOffset = { height: randomHeight, offset: i }\n    heightOffsets.push(newHeightOffset)\n    i += randomHeight\n  }\n  const trimmedHeightOffsets = heightOffsets.slice(0, -1)\n  const [lastSet] = trimmedHeightOffsets.slice(-1)\n  const lastHeightOffset = {\n    height: height - (lastSet?.offset + lastSet?.height),\n    offset: lastSet?.offset + lastSet?.height,\n  }\n  if (!lastSet) return []\n  return [...trimmedHeightOffsets, lastHeightOffset]\n}\n\nexport const getRatio = (imageDims: DimensionsType) => {\n  return imageDims.width / imageDims.height\n}\n\nexport const getRatioImageSize = (\n  containerDims: DimensionsType,\n  imageDims: DimensionsType,\n) => {\n  const imageRatio = getRatio(imageDims)\n  return {\n    height: containerDims.height,\n    width: containerDims.height * imageRatio,\n  }\n}\n","import { RefObject, useEffect, useRef } from 'react'\n\nexport const useObserver = (callback: () => void, element: RefObject<HTMLDivElement>) => {\n  const observer = useRef<any>(null)\n\n  useEffect(() => {\n    if (!element.current) return\n    const { current } = element\n    const observe = () => {\n      if (current && observer.current) {\n        observer.current.observe(current)\n      }\n    }\n    // if we are already observing old element\n    if (observer && observer.current && current) {\n      observer.current.unobserve(current)\n    }\n    observer.current = new ResizeObserver(callback);\n    observe()\n\n    return () => {\n      if (observer && observer.current && current) {\n        observer.current.unobserve(current)\n      }\n    }\n  }, [element, callback])\n}\n","import React, { useState, useEffect } from 'react'\nimport { getRandomNumberBetween } from '../helpers'\n\nexport const Slice: React.FC<{\n  isGlitching: boolean,\n  top: number,\n  imageHeight: number,\n  image: string,\n}> = ({ isGlitching, top, imageHeight, image }) => {\n  const [translateX, setTranslateX] = useState(0)\n  const [hue, setHue] = useState(0)\n  const [negativeTranslate, setNegativeTranslate] = useState(false)\n\n  const glitch = () => {\n    setNegativeTranslate(getRandomNumberBetween(0, 2) !== 0)\n    setTranslateX(getRandomNumberBetween(1, 25))\n    setHue((getRandomNumberBetween(0, 360)))\n  }\n\n  const returnToNormal = () => {\n    setTranslateX(0)\n    setHue(0)\n  }\n\n  useEffect(() => {\n    const randomInterval = getRandomNumberBetween(1, 1000)\n    const interval = setInterval(() => {\n      isGlitching ? glitch() : returnToNormal()\n    }, randomInterval)\n    return () => clearInterval(interval)\n  })\n\n  return (\n    <div\n      className=\"Slice\"\n      style={{\n        backgroundImage: `url(${image})`,\n        backgroundSize: 'contain',\n        backgroundRepeat: 'no-repeat',\n        backgroundPosition: 'center',\n        height: imageHeight,\n        transform: `translateY(-${top}px) translateX(${negativeTranslate ? '-' : ''}${translateX}px)`,\n        filter: `hue-rotate(${hue}deg)`,\n      }}\n    />\n  )\n}\n","import React, { useState, useEffect, useRef } from 'react'\nimport { createSlices, getRandomNumberBetween, getRatioImageSize } from '../helpers'\nimport { useObserver } from '../hooks'\nimport { heightOffsetType } from '../Typings'\nimport { Slice } from './Slice'\n\nexport const GlitchedImage: React.FC<{ image: string}> = ({ image }) => {\n  const slicesRef = useRef<HTMLDivElement>(null)\n  const [containerDims, setContainerDims] = useState({ width: 0, height: 0 })\n  const [imageDims, setImageDims] = useState({ width: 0, height: 0 })\n  const [heightOffsets, setHeightOffsets] = useState<heightOffsetType[]>([])\n  const [isGlitching, setIsGlitching] = useState(false)\n  const runInObserver = () => {\n    setContainerDims({\n      width: slicesRef.current?.clientWidth || 0,\n      height: slicesRef.current?.clientHeight || 0,\n    })\n  }\n  useObserver(runInObserver, slicesRef)\n\n\n  // get image width and height\n  useEffect(() => {\n    const myImage = new Image()\n    myImage.onload = () => {\n      setImageDims(\n        getRatioImageSize(\n          containerDims,\n          { height: myImage.height, width: myImage.width },\n        ),\n      )\n    }\n    myImage.src = image\n\n  }, [image, containerDims])\n\n  // trigger glitching with random intervals\n  useEffect(() => {\n    const lowRandom = getRandomNumberBetween(100, 600)\n    const highRandom = getRandomNumberBetween(1000, 3000)\n    const timer = isGlitching ? lowRandom : highRandom\n    const interval = setInterval(() => {\n      setIsGlitching((prevGlitching) => !prevGlitching)\n    }, timer)\n    return () => clearInterval(interval)\n  }, [isGlitching])\n\n  // create heightOffsets array with container height\n  useEffect(() => {\n    setHeightOffsets(createSlices(containerDims.height))\n  }, [containerDims.height, containerDims.width])\n  return (\n    <div style={{ height: '100%', width: '100%' }} ref={slicesRef}>\n      {heightOffsets.map((heightOffset, i) => (\n        <div\n          key={i}\n          style={{\n            position: 'relative',\n            height: heightOffset.height,\n            overflow: 'hidden',\n          }}\n        >\n          <Slice\n            isGlitching={isGlitching}\n            top={heightOffset.offset}\n            imageHeight={imageDims.height}\n            image={image}\n          />\n        </div>\n      ))}\n    </div>\n  )\n}\n"],"names":["getRandomNumberBetween","min","max","Math","floor","random","createSlices","height","heightOffsets","i","randomHeight","newHeightOffset","offset","push","trimmedHeightOffsets","slice","lastSet","lastHeightOffset","getRatio","imageDims","width","getRatioImageSize","containerDims","imageRatio","useObserver","callback","element","observer","useRef","useEffect","current","observe","unobserve","ResizeObserver","Slice","isGlitching","top","imageHeight","image","useState","translateX","setTranslateX","hue","setHue","negativeTranslate","setNegativeTranslate","glitch","returnToNormal","randomInterval","interval","setInterval","clearInterval","React","className","style","backgroundImage","backgroundSize","backgroundRepeat","backgroundPosition","transform","filter","GlitchedImage","slicesRef","setContainerDims","setImageDims","setHeightOffsets","setIsGlitching","runInObserver","clientWidth","clientHeight","myImage","Image","onload","src","lowRandom","highRandom","timer","prevGlitching","ref","map","heightOffset","key","position","overflow"],"mappings":"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"}